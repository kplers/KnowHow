## 에피소드3. 부동소수점 연산

**과목**(Subject): **Great Code 1권**
**교재 범위**(Scope): Ch4

> **알림**: 에피소드 1, 2는 추후에 업로드될 예정입니다. 멀지 않은 시일 내에 업로드될 계획이지만, 본 카테고리의 게시물들은 랜달 하이드 저 \<Great Code> 시리즈를 바탕으로 간략하게 재구성한 것이므로, 이전 내용을 먼저 공부하고 싶으신 분들은 책의 Ch2~3 내용을 읽어주십시오. Ch2는 컴퓨터의 수 표기법, Ch3는 2진법 계산 및 비트 연산에 대해 다루고 있습니다.

> **알림**: 본 문서는 교재에 있는 대부분의 주요 내용을 포함하지만 모든 내용을 포함하지는 않습니다. 모든 내용을 빠짐없이 공부하고 싶은 분들은 교재를 직접 참고하시기 바랍니다.

## 개요  
정수가 아닌 실수 연산(real arithmetic) 시에는 정수 타입을 사용할 수 없으므로, 부동소수점 연산을 통해 정확한 값의 근삿값을 구한다. 어디까지나 근삿값이므로 정확성이 떨어질 수 있다.  
&emsp;근사를 하는 이유는 실수는 무한히 많은데 부동소수점 수를 표현할 때 사용하는 비트의 수는 정해져 있기 때문이다. 따라서 컴퓨터에서 표현 가능한 실수는 유한하다.
* **부동소수점** 형식은 정수 표기와 고정소수점 형식의 문제점을 해결하기 위한 형식이다.
  * **정수** **표기**: 정수만 표현할 수 있고, n개의 비트로 $-2^{n-1}..2^{n-1}-1$ 또는 $0..2^n-1$ 범위만 표현 가능.
  * **고정소수점**: 정수 표기보다도 범위가 줄어든다.
* 소수점의 위치를 필요에 따라 **자유롭게 움직일 수 있다**. 예를 들어 소수점이 두 개만 필요하면 0, 1번 비트만 소수점으로 사용한다. 이를 위해 소수점의 위치를 나타내는 필드를 추가해야 한다 (=지수)
* 부동소수점은 일부 비트로 구성된 **가수**(mantissa)와 **지수**(exponent)로 구성된다.
  * **가수**: 일정 범위(e.g. 0~1)의 기본 수
  * **지수**: 가수에 곱해지는 수.
  * 과학적 표기법을 생각해보면 쉽다. 예를 들어 3.86e+5에서 3.86이 가수, 5가 지수에 해당한다.
* 가수와 지수 표기법을 이용해 부동소수점 형식은 매우 넓은 범위의 수를 표현할 수 있다.
* 다만 여전히 사용하는 비트의 수는 정해져 있으므로, 일정 개수의 유효 자릿수(또는 유효숫자, significant digit)로 이루어진 수만 표현할 수 있다.
  * 유효숫자에 대한 자세한 설명은 [위키백과](https://ko.wikipedia.org/wiki/%EC%9C%A0%ED%9A%A8%EC%88%AB%EC%9E%90)를 참고하십시오.
* 보통 가수의 유효 자릿수보다 지수의 최댓값과 최솟값의 차이가 더 크기 때문에, 모든 범위의 수를 정확하게 표현할 수 없다.
  * 오히려 정수 표기법보다도 나타낼 수 있는 수가 다양하지 않다. 1.00e+3와 0.10e+4가 같은 값이듯이, 다른 표기법으로 같은 숫자를 표현하기 때문에 그만큼 표현할 수 있는 경우의 수가 줄어든다.
* 계산이 복잡하다. 두 개의 수를 더하거나 빼려면 지수를 맞춰줘야 한다. 그 뒤 유효자릿수가 안 맞으면 결과값을 라운딩(rounding, 올림/내림/반올림)하거나 제거(잘라냄)해야 한다. 
  * 예를 들어 1.23e+1과 4.56e+0를 더하려면 4.56e+0=0.456e+1으로 지수를 맞추고 더해서 1.686e+1으로 만들고, 유효숫자를 맞추기 위해 라운딩해서 1.69e+1으로 만들어야 한다.
  * **보호 자릿수**(또는 보호 숫자/[2진 형식]보호 비트, guard digit/guard bit): 계산에 사용한 추가 자릿수. 위의 예의 경우 0.456의 6 자리에 해당하는 자릿수이다. 1.23e1에는 없는 자릿수이기 때문에 추가 자릿수이다. 보호 자릿수를 사용하면 계산의 정확도가 올라간다.
* 연산이 거듭될수록 오차가 누적되어 연산 결과에 큰 영향을 미친다.
  * 3.33e+3에 1.00e+0을 100번 더하는 경우를 생각해보자.
  * 1.00e+0을 먼저 100번 더한 다음 3.33e+3에 더하면 완전히 다른 결과가 나온다.
* 따라서, 제한된 정확도 조건에서 **부동소수점 연산의 순서는 연산 결과의 정확도에 영향**을 미칠 수 있다.